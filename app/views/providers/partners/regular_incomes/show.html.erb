<%= form_with model: @form,
              url: providers_legal_aid_application_partners_regular_incomes_path(@legal_aid_application),
              method: :patch do |f| %>
  <%= page_template page_title: t(".page_title"), template: :basic, form: f do %>
    <span class="govuk-caption-xl"><%= t("generic.partner_means_caption") %></span>
    <%= f.govuk_check_boxes_fieldset :transaction_type_ids, legend: { tag: "h1", size: "xl" } do %>

      <%= render "shared/means/cost_of_living_and_disregarded_benefits" %>

      <% @form.transaction_type_options.each_with_index do |transaction_type, index| %>
        <%= f.govuk_check_box :transaction_type_ids,
                              transaction_type.id,
                              link_errors: index.zero?,
                              label: { text: t(".labels.#{transaction_type.name}") },
                              hint: { text: t(".hints.#{transaction_type.name}") } do %>
          <%= f.govuk_text_field "#{transaction_type.name}_amount".to_sym,
                                 width: "one-quarter",
                                 prefix_text: "Â£" %>
          <%= f.govuk_collection_radio_buttons "#{transaction_type.name}_frequency".to_sym,
                                               RegularTransaction.frequencies_for(transaction_type),
                                               :itself,
                                               ->(option) { t("transaction_types.frequencies.#{option}") },
                                               legend: { tag: "h2", size: "s" } %>
        <% end %>
      <% end %>

      <%= f.govuk_check_box_divider %>

      <%= f.govuk_check_box :transaction_type_ids,
                            @form.none_selected,
                            exclusive: true,
                            label: { text: t(".labels.none") } %>
    <% end %>

    <%= f.govuk_submit t("generic.save_and_continue") %>
  <% end %>
<% end %>
