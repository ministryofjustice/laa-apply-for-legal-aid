class BlobMalwareScanner
  include ActiveStorage::Downloading

  attr_reader :blob

  def initialize(blob)
    @blob = blob
  end

  def call
    download_blob_to_tempfile { |file| Clamby.safe?(file.path) }
  end
end
